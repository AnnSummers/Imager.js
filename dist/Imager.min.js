!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.imager=e()}}(function(){return function e(t,i,n){function r(s,o){if(!i[s]){if(!t[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[s]={exports:{}};t[s][0].call(u.exports,function(e){var i=t[s][1][e];return r(i?i:e)},u,u.exports,e,t,i,n)}return i[s].exports}for(var a="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./src/utils.js"),o=e("./src/transforms.js"),l=n(o),c=document,u=[96,130,165,200,235,270,304,340,375,410,445,485,520,555,590,625,660,695,736],h=function(){function e(t){var i=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(r(this,e),void 0===t)throw new Error("Imager.js now expects the first argument to be either a CSS string selector or a collection of HTMLElement.");"string"==typeof t?(n.selector=t,t=void 0):"undefined"==typeof t.length&&(n=t,t=void 0),this.viewportHeight=c.documentElement.clientHeight,this.selector=t?null:n.selector||".delayed-image-load",this.className=n.className||"image-replace",this.gif=c.createElement("img"),this.gif.src="data:image/gif;base64,R0lGODlhEAAJAIAAAP///wAAACH5BAEAAAAALAAAAAAQAAkAAAIKhI+py+0Po5yUFQA7",this.gif.className=this.className,this.gif.alt="",this.lazyloadOffset=n.lazyloadOffset||0,this.scrollDelay=n.scrollDelay||250,this.onResize=n.hasOwnProperty("onResize")?n.onResize:!0,this.lazyload=n.hasOwnProperty("lazyload")?n.lazyload:!1,this.scrolled=!1,this.availablePixelRatios=n.availablePixelRatios||[1,2],this.availableWidths=n.availableWidths||u,this.onImagesReplaced=n.onImagesReplaced||s.noop,this.widthsMap={},this.refreshPixelRatio(),this.widthInterpolator=n.widthInterpolator||s.returnFn,this.gif.removeAttribute("height"),this.gif.removeAttribute("width"),"function"!=typeof this.availableWidths&&("number"==typeof this.availableWidths.length?this.widthsMap=e.createWidthsMap(this.availableWidths,this.widthInterpolator,this.devicePixelRatio):(this.widthsMap=this.availableWidths,this.availableWidths=Object.keys(this.availableWidths)),this.availableWidths=this.availableWidths.sort(function(e,t){return e-t})),this.divs=[],this.add(t||this.selector),this.ready(n.onReady),setTimeout(function(){return i.init()},0)}return a(e,[{key:"init",value:function(){var e=this;this.initialized=!0;var t=s.trueFn;this.lazyload?(this.registerScrollEvent(),this.scrolled=!0,this.scrollCheck(),t=function(t){return e.isPlaceholder(t)===!1}):this.checkImagesNeedReplacing(this.divs),this.onResize&&this.registerResizeEvent(t),this.onReady()}},{key:"ready",value:function(e){this.onReady=e||s.noop}},{key:"add",value:function(e){e=e||this.selector;var t="string"==typeof e?document.querySelectorAll(e):e;if(t&&t.length){var i=t.map(s.returnFn);this.changeDivsToEmptyImages(i),this.divs=this.divs.concat(i)}}},{key:"scrollCheck",value:function(){var e=this,t=0,i=[];this.scrolled&&(this.divs.forEach(function(n){e.isPlaceholder(n)&&(++t,e.isThisElementOnScreen(n)&&i.push(n))}),0===t&&window.clearInterval(this.interval),this.changeDivsToEmptyImages(i),this.scrolled=!1)}},{key:"createGif",value:function(e){if(e.className.match(new RegExp("(^| )"+this.className+"( |$)")))return e;var t=e.getAttribute("data-class"),i=e.getAttribute("data-width"),n=this.gif.cloneNode(!1);return i&&(n.width=i,n.setAttribute("data-width",i)),n.className=(t?t+" ":"")+this.className,n.setAttribute("data-src",e.getAttribute("data-src")),n.setAttribute("alt",e.getAttribute("data-alt")||this.gif.alt),e.parentNode.replaceChild(n,e),n}},{key:"changeDivsToEmptyImages",value:function(e){var t=this;e.forEach(function(i,n){e[n]=t.createGif(i)}),this.initialized&&this.checkImagesNeedReplacing(e)}},{key:"isPlaceholder",value:function(e){return e.src===this.gif.src}},{key:"isThisElementOnScreen",value:function(t){var i=0,n=e.getPageOffset()+this.lazyloadOffset;if(t.offsetParent)do i+=t.offsetTop;while(t=t.offsetParent);return i<this.viewportHeight+n}},{key:"checkImagesNeedReplacing",value:function(e,t){var i=this;t=t||s.trueFn,this.isResizing||(this.isResizing=!0,this.refreshPixelRatio(),e.forEach(function(e){t(e)&&i.replaceImagesBasedOnScreenDimensions(e)}),this.isResizing=!1,this.onImagesReplaced(e))}},{key:"replaceImagesBasedOnScreenDimensions",value:function(t){var i,n;n=e.getNaturalWidth(t),i="function"==typeof this.availableWidths?this.availableWidths(t):this.determineAppropriateResolution(t),t.width=i,!this.isPlaceholder(t)&&n>=i||(t.src=this.changeImageSrcToUseNewImageDimensions(t.getAttribute("data-src"),i),t.removeAttribute("width"),t.removeAttribute("height"))}},{key:"determineAppropriateResolution",value:function(t){return e.getClosestValue(t.getAttribute("data-width")||t.parentNode.clientWidth,this.availableWidths)}},{key:"refreshPixelRatio",value:function(){this.devicePixelRatio=e.getClosestValue(e.getPixelRatio(),this.availablePixelRatios)}},{key:"changeImageSrcToUseNewImageDimensions",value:function(e,t){return e.replace(/{width}/g,l.width(t,this.widthsMap)).replace(/{pixel_ratio}/g,l.pixelRatio(this.devicePixelRatio))}},{key:"registerResizeEvent",value:function(e){var t=this;window.addEventListener("resize",(0,s.debounce)(function(){return t.checkImagesNeedReplacing(t.divs,e)},100))}},{key:"registerScrollEvent",value:function(){var e=this;this.scrolled=!1,this.interval=window.setInterval(function(){return e.scrollCheck()},this.scrollDelay),window.addEventListener("scroll",function(){e.scrolled=!0}),window.addEventListener("resize",function(){e.viewportHeight=document.documentElement.clientHeight,e.scrolled=!0})}}],[{key:"getPixelRatio",value:function(e){return(e||window).devicePixelRatio||1}},{key:"createWidthsMap",value:function(e,t,i){for(var n={},r=e.length;r--;)n[e[r]]=t(e[r],i);return n}},{key:"getClosestValue",value:function(e,t){var i=t.length,n=t[i-1];for(e=parseFloat(e);i--;)e<=t[i]&&(n=t[i]);return n}},{key:"getPageOffsetGenerator",value:function(e){return e?function(){return window.pageYOffset}:function(){return document.documentElement.scrollTop}}}]),e}();i["default"]=h,h.getNaturalWidth=function(){return"naturalWidth"in new Image?function(e){return e.naturalWidth}:function(e){var t=document.createElement("img");return t.src=e.src,t.width}}(),h.getPageOffset=h.getPageOffsetGenerator(Object.prototype.hasOwnProperty.call(window,"pageYOffset"))},{"./src/transforms.js":2,"./src/utils.js":3}],2:[function(e,t,i){"use strict";function n(e){return 1===e?"":"-"+e+"x"}function r(e,t){return t[e]||e}Object.defineProperty(i,"__esModule",{value:!0}),i.pixelRatio=n,i.width=r},{}],3:[function(e,t,i){"use strict";function n(e){return e}function r(){}function a(){return!0}function s(e,t){var i;return function(){var n=this,r=arguments,a=function(){i=null,e.apply(n,r)};clearTimeout(i),i=setTimeout(a,t)}}Object.defineProperty(i,"__esModule",{value:!0}),i.returnFn=n,i.noop=r,i.trueFn=a,i.debounce=s},{}]},{},[1])(1)});
//# sourceMappingURL=./Imager.map.js